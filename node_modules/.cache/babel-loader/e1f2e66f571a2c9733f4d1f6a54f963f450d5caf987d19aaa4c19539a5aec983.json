{"ast":null,"code":"import _regeneratorRuntime from\"/Users/HenryTsui/Desktop/rizzy-bodycraft-record/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/HenryTsui/Desktop/rizzy-bodycraft-record/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/HenryTsui/Desktop/rizzy-bodycraft-record/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useCallback,useContext,useState}from\"react\";import{useNavigate}from\"react-router-dom\";import{Title}from\"../../../components/Title/Title\";import Firebase from\"../../../firebase\";import{SetLoggedInContext}from\"../../../hooks/contexts\";import{useInput}from\"../../../hooks/useInput\";import\"./SignUp.css\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export var SignUp=function SignUp(){var navigate=useNavigate();var setLoggedIn=useContext(SetLoggedInContext);var _useState=useState(false),_useState2=_slicedToArray(_useState,2),verifiedEmail=_useState2[0],setVerifiedEmail=_useState2[1];var _useInput=useInput(\"hksahenry@gmail.com\"),_useInput2=_slicedToArray(_useInput,2),email=_useInput2[0],setEmail=_useInput2[1];var _useInput3=useInput(\"\"),_useInput4=_slicedToArray(_useInput3,2),name=_useInput4[0],setName=_useInput4[1];var _useInput5=useInput(\"\"),_useInput6=_slicedToArray(_useInput5,2),password=_useInput6[0],setPassword=_useInput6[1];var _useInput7=useInput(\"\"),_useInput8=_slicedToArray(_useInput7,2),confirmPassword=_useInput8[0],setConfirmPassword=_useInput8[1];var onInput=useCallback(function(set,e){set(e.currentTarget.value);},[]);var onVerify=useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var verified,isNewAccount;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return Firebase.instance.login({email:email});case 2:verified=_context.sent;if(!verified){_context.next=9;break;}setLoggedIn(Firebase.instance.auth.currentUser!==null);_context.next=7;return Firebase.instance.checkNewAccount(email);case 7:isNewAccount=_context.sent;if(isNewAccount)setVerifiedEmail(true);else navigate(\"/dashboard\");case 9:case\"end\":return _context.stop();}},_callee);})),[email]);var onBackToLogin=useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.next=2;return Firebase.instance.logout();case 2:navigate(\"/\",{replace:true});case 3:case\"end\":return _context2.stop();}},_callee2);})),[]);var onSignup=useCallback(function(){Firebase.instance.signup(email,password,name);},[email,password,name]);return/*#__PURE__*/_jsxs(\"main\",{id:\"signup\",children:[/*#__PURE__*/_jsx(Title,{}),!verifiedEmail&&/*#__PURE__*/_jsxs(\"section\",{id:\"verify_email\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Verify your email\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:email,placeholder:\"Email\",onChange:function onChange(e){return onInput(setEmail,e);}}),/*#__PURE__*/_jsx(\"button\",{onClick:onVerify,children:\"Verify\"}),/*#__PURE__*/_jsx(\"button\",{onClick:onBackToLogin,children:\"Back to Login\"})]}),verifiedEmail&&/*#__PURE__*/_jsxs(\"section\",{id:\"signup_details\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Sign up\"}),/*#__PURE__*/_jsxs(\"div\",{id:\"signup_row\",children:[/*#__PURE__*/_jsx(\"div\",{children:\"Email:\"}),/*#__PURE__*/_jsx(\"div\",{children:email})]}),/*#__PURE__*/_jsxs(\"div\",{id:\"signup_row\",children:[/*#__PURE__*/_jsx(\"div\",{children:\"Name:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:name,placeholder:\"Name\",onChange:function onChange(e){return onInput(setName,e);}})]}),/*#__PURE__*/_jsxs(\"div\",{id:\"signup_row\",children:[/*#__PURE__*/_jsx(\"div\",{children:\"Password:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",value:password,placeholder:\"Password\",onChange:function onChange(e){return onInput(setPassword,e);}})]}),/*#__PURE__*/_jsxs(\"div\",{id:\"signup_row\",children:[/*#__PURE__*/_jsx(\"div\",{children:\"Confirm Password:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",value:confirmPassword,placeholder:\"Confirm Password\",onChange:function onChange(e){return onInput(setConfirmPassword,e);}})]}),/*#__PURE__*/_jsx(\"button\",{onClick:onSignup,children:\"Sign Up\"}),/*#__PURE__*/_jsx(\"button\",{onClick:onBackToLogin,children:\"Back to Login\"}),/*#__PURE__*/_jsx(\"div\",{children:\"If you do not complete the sign up procedure now, you will need to request a new email link to login again\"})]})]});};","map":{"version":3,"names":["useCallback","useContext","useState","useNavigate","Title","Firebase","SetLoggedInContext","useInput","SignUp","navigate","setLoggedIn","verifiedEmail","setVerifiedEmail","email","setEmail","name","setName","password","setPassword","confirmPassword","setConfirmPassword","onInput","set","e","currentTarget","value","onVerify","instance","login","verified","auth","currentUser","checkNewAccount","isNewAccount","onBackToLogin","logout","replace","onSignup","signup"],"sources":["/Users/HenryTsui/Desktop/rizzy-bodycraft-record/src/pages/User/SignUp/Signup.tsx"],"sourcesContent":["import { useCallback, useContext, useState } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport { Title } from \"../../../components/Title/Title\";\nimport Firebase from \"../../../firebase\";\nimport { SetLoggedInContext } from \"../../../hooks/contexts\";\nimport { useInput } from \"../../../hooks/useInput\";\nimport \"./SignUp.css\";\n\nexport const SignUp = () => {\n    const navigate = useNavigate();\n    const setLoggedIn = useContext(SetLoggedInContext);\n    const [verifiedEmail, setVerifiedEmail] = useState(false);\n    const [email, setEmail] = useInput(\"hksahenry@gmail.com\");\n    const [name, setName] = useInput(\"\");\n    const [password, setPassword] = useInput(\"\");\n    const [confirmPassword, setConfirmPassword] = useInput(\"\");\n\n    const onInput = useCallback((set: React.Dispatch<string>, e: React.ChangeEvent<HTMLInputElement>) => {\n        set(e.currentTarget.value);\n    }, []);\n\n    const onVerify = useCallback(async () => {\n        let verified = await Firebase.instance.login({ email: email });\n        if (verified) {\n            setLoggedIn(Firebase.instance.auth.currentUser !== null);\n            let isNewAccount = await Firebase.instance.checkNewAccount(email)\n            if (isNewAccount) setVerifiedEmail(true);\n            else navigate(\"/dashboard\");\n        }\n    }, [email]);\n\n    const onBackToLogin = useCallback(async () => {\n        await Firebase.instance.logout();\n        navigate(\"/\", { replace: true })\n    }, []);\n\n    const onSignup = useCallback(() => {\n        Firebase.instance.signup(email, password, name);\n    }, [email, password, name]);\n\n    return (\n        <main id=\"signup\">\n            <Title />\n            { !verifiedEmail &&\n                <section id=\"verify_email\">\n                    <h3>Verify your email</h3>\n                    <input type=\"text\" value={ email } placeholder=\"Email\" onChange={ (e) => onInput(setEmail, e) } />\n                    <button onClick={ onVerify }>Verify</button>\n                    <button onClick={ onBackToLogin }>Back to Login</button>\n                </section>\n            }\n            { verifiedEmail &&\n                <section id=\"signup_details\">\n                    <h3>Sign up</h3>\n                    <div id=\"signup_row\">\n                        <div>Email:</div>\n                        <div>{ email }</div>\n                    </div>\n                    <div id=\"signup_row\">\n                        <div>Name:</div>\n                        <input type=\"text\" value={ name } placeholder=\"Name\" onChange={ (e) => onInput(setName, e) } />\n                    </div>\n                    <div id=\"signup_row\">\n                        <div>Password:</div>\n                        <input type=\"password\" value={ password } placeholder=\"Password\" onChange={ (e) => onInput(setPassword, e) } />\n                    </div>\n                    <div id=\"signup_row\">\n                        <div>Confirm Password:</div>\n                        <input type=\"password\" value={ confirmPassword } placeholder=\"Confirm Password\" onChange={ (e) => onInput(setConfirmPassword, e) } />\n                    </div>\n                    <button onClick={ onSignup }>Sign Up</button>\n                    <button onClick={ onBackToLogin }>Back to Login</button>\n                    <div>If you do not complete the sign up procedure now, you will need to request a new email link to login again</div>\n                </section>\n            }\n        </main>\n    )\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}