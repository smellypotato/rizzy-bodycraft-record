{"ast":null,"code":"var _jsxFileName = \"/Users/HenryTsui/Desktop/rizzy-bodycraft-record/src/pages/Admin/Categories/Categories.tsx\",\n  _s = $RefreshSig$();\nimport { useCallback, useEffect, useState } from \"react\";\nimport { DropdownMenu } from \"../../../components/DropdownMenu/DropdownMenu\";\nimport { Title } from \"../../../components/Title/Title\";\nimport Firebase from \"../../../firebase\";\nimport \"./Categories.css\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const Categories = () => {\n  _s();\n  var _categories$find;\n  const [categories, setCategories] = useState([]);\n  const [categoryId, setCategoryId] = useState();\n  const [activeDropdown, setActiveDropdown] = useState();\n  const [options, setOptions] = useState([]);\n  const [addModal, setAddModal] = useState();\n  const [addLabel, setAddLabel] = useState(\"\");\n  useEffect(() => {\n    let closeDropdown = () => {\n      console.log(\"close dropdown\");\n      setActiveDropdown(undefined);\n    };\n    window.addEventListener(\"click\", closeDropdown);\n    return () => window.removeEventListener(\"click\", closeDropdown);\n  }, []);\n  useEffect(() => {\n    Firebase.instance.getCategories().then(categories => setCategories(categories.map(category => {\n      return {\n        label: category.title,\n        id: category.id\n      };\n    })));\n  }, []);\n\n  // useEffect(() => {\n  //     if (categoryId) Firebase.instance.getOptions(categoryId).then(options => setOptions(options));\n  // }, [categoryId]);\n\n  useEffect(() => {\n    if (categoryId) Firebase.instance.onOptionUpdate(categoryId, options => setOptions(options));\n  }, [categoryId]);\n  const onInput = useCallback((set, e) => {\n    set(e.currentTarget.value);\n  }, []);\n  const optionRow = useCallback(details => {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"option\",\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"delete\",\n        onClick: () => Firebase.instance.deleteOption(categoryId, details.id)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 49,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        value: details.title,\n        onChange: () => {}\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 50,\n        columnNumber: 17\n      }, this), details.choices ? /*#__PURE__*/_jsxDEV(DropdownMenu, {\n        onSelect: (_id, e) => e.stopPropagation(),\n        opened: activeDropdown === details.id,\n        onOpen: () => setActiveDropdown(details.id),\n        onClose: () => setActiveDropdown(undefined),\n        default: \"顯示所有選項\",\n        current: \"\",\n        choices: details.choices.map(choice => {\n          return {\n            id: details.id,\n            label: choice,\n            allowRemove: true\n          };\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 52,\n        columnNumber: 25\n      }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n        children: \"\\u8F38\\u5165\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 53,\n        columnNumber: 25\n      }, this)]\n    }, details.id, true, {\n      fileName: _jsxFileName,\n      lineNumber: 48,\n      columnNumber: 13\n    }, this);\n  }, [options, activeDropdown]);\n  const addInputPanel = () => {\n    console.log(\"add input panel\");\n    setAddModal( /*#__PURE__*/_jsxDEV(\"dialog\", {\n      open: true,\n      children: /*#__PURE__*/_jsxDEV(\"section\", {\n        id: \"panel\",\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          children: \"\\u65B0\\u589E\\u8F38\\u5165\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 64,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            children: \"\\u9805\\u76EE\\u6A19\\u7C64\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 66,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            value: addLabel,\n            onChange: e => {\n              console.log(\"input\");\n              onInput(setAddLabel, e);\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 67,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 65,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            children: \"\\u78BA\\u5B9A\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 70,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            children: \"\\u53D6\\u6D88\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 71,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 69,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 63,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 13\n    }, this));\n  };\n  return /*#__PURE__*/_jsxDEV(\"main\", {\n    id: \"categories\",\n    children: [/*#__PURE__*/_jsxDEV(Title, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"section\", {\n      id: \"content\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        id: \"dropdown_big\",\n        children: /*#__PURE__*/_jsxDEV(DropdownMenu, {\n          onSelect: setCategoryId,\n          opened: activeDropdown === \"category\",\n          onOpen: () => setActiveDropdown(\"category\"),\n          onClose: () => setActiveDropdown(undefined),\n          default: \"選擇分類\",\n          current: (_categories$find = categories.find(cat => cat.id === categoryId)) === null || _categories$find === void 0 ? void 0 : _categories$find.label,\n          choices: categories\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 83,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 82,\n        columnNumber: 17\n      }, this), options.map(option => optionRow(option)), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"add\",\n        onClick: () => {},\n        children: \"\\u65B0\\u589E\\u9078\\u9805 \\uFF0B\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"add\",\n        onClick: addInputPanel,\n        children: \"\\u65B0\\u589E\\u8F38\\u5165 \\uFF0B\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 13\n    }, this), addModal && addModal]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 79,\n    columnNumber: 9\n  }, this);\n};\n_s(Categories, \"pHYFvOlCdNOceRy0D/dOWGPNKnc=\");\n_c = Categories;\nvar _c;\n$RefreshReg$(_c, \"Categories\");","map":{"version":3,"names":["useCallback","useEffect","useState","DropdownMenu","Title","Firebase","Categories","categories","setCategories","categoryId","setCategoryId","activeDropdown","setActiveDropdown","options","setOptions","addModal","setAddModal","addLabel","setAddLabel","closeDropdown","console","log","undefined","window","addEventListener","removeEventListener","instance","getCategories","then","map","category","label","title","id","onOptionUpdate","onInput","set","e","currentTarget","value","optionRow","details","deleteOption","choices","_id","stopPropagation","choice","allowRemove","addInputPanel","find","cat","option"],"sources":["/Users/HenryTsui/Desktop/rizzy-bodycraft-record/src/pages/Admin/Categories/Categories.tsx"],"sourcesContent":["import { useCallback, useEffect, useState } from \"react\";\nimport { DropdownMenu } from \"../../../components/DropdownMenu/DropdownMenu\";\nimport { Title } from \"../../../components/Title/Title\";\nimport Firebase from \"../../../firebase\";\nimport \"./Categories.css\";\nimport { Option } from \"../../../type\";\nexport const Categories = () => {\n\n    const [categories, setCategories] = useState<Array<{ label: string, id: string }>>([]);\n    const [categoryId, setCategoryId] = useState<string>();\n    const [activeDropdown, setActiveDropdown] = useState<string>();\n    const [options, setOptions] = useState<Array<Option>>([]);\n    const [addModal, setAddModal] = useState<JSX.Element>();\n    const [addLabel, setAddLabel] = useState(\"\");\n\n    useEffect(() => {\n        let closeDropdown = () => {\n            console.log(\"close dropdown\");\n            setActiveDropdown(undefined)\n        };\n        window.addEventListener(\"click\", closeDropdown);\n\n        return () => window.removeEventListener(\"click\", closeDropdown);\n    }, [])\n\n    useEffect(() => {\n        Firebase.instance.getCategories().then(categories =>\n            setCategories(categories.map(category => {\n                return { label: category.title, id: category.id }\n            }))\n        );\n    }, [])\n\n    // useEffect(() => {\n    //     if (categoryId) Firebase.instance.getOptions(categoryId).then(options => setOptions(options));\n    // }, [categoryId]);\n\n    useEffect(() => {\n        if (categoryId) Firebase.instance.onOptionUpdate(categoryId, (options) => setOptions(options));\n    }, [categoryId])\n\n    const onInput = useCallback((set: React.Dispatch<string>, e: React.ChangeEvent<HTMLInputElement>) => {\n        set(e.currentTarget.value);\n    }, []);\n\n    const optionRow = useCallback((details: Option) => {\n        return (\n            <div className=\"option\" key={ details.id }>\n                <button className=\"delete\" onClick={ () => Firebase.instance.deleteOption(categoryId!, details.id)}/>\n                <input value={ details.title } onChange={ () => {} } />\n                {   details.choices ?\n                        <DropdownMenu onSelect={ (_id, e) => e.stopPropagation() } opened={ activeDropdown === details.id } onOpen={ () => setActiveDropdown(details.id) } onClose={ () => setActiveDropdown(undefined) } default={ \"顯示所有選項\" } current={ \"\" } choices={ details.choices.map(choice => { return { id: details.id, label: choice, allowRemove: true } }) } /> :\n                        <div>輸入</div>\n                }\n            </div>\n        )\n    }, [options, activeDropdown]);\n\n    const addInputPanel = () => {\n        console.log(\"add input panel\")\n        setAddModal(\n            <dialog open>\n                <section id=\"panel\">\n                    <h2>新增輸入</h2>\n                    <div>\n                        <div>項目標籤</div>\n                        <input value={ addLabel } onChange={ (e) => {console.log(\"input\"); onInput(setAddLabel, e)} }/>\n                    </div>\n                    <div>\n                        <button>確定</button>\n                        <button>取消</button>\n                    </div>\n                </section>\n            </dialog>\n        )\n    };\n\n    return (\n        <main id=\"categories\">\n            <Title />\n            <section id=\"content\">\n                <div id=\"dropdown_big\">\n                    <DropdownMenu onSelect={ setCategoryId } opened={ activeDropdown === \"category\"} onOpen={ () => setActiveDropdown(\"category\") } onClose={ () => setActiveDropdown(undefined) } default={ \"選擇分類\" } current={ categories.find(cat => cat.id === categoryId)?.label } choices={ categories } />\n                </div>\n                { options.map(option => optionRow(option)) }\n                <button className=\"add\" onClick={ () => {} }>新增選項 ＋</button>\n                <button className=\"add\" onClick={ addInputPanel }>新增輸入 ＋</button>\n            </section>\n            { addModal && addModal }\n        </main>\n    )\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}